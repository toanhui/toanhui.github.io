!function(){try{var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="263d2ff2-9de6-4388-9611-df319b14c4c9",t._sentryDebugIdIdentifier="sentry-dbid-263d2ff2-9de6-4388-9611-df319b14c4c9")}catch(t){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2942],{66075:function(t,e,a){a.d(e,{x:function(){return T},g:function(){return C}});var n=a(59917),r=a(17638),i=a(55791),o=a(13717),s=a(88089),l=a(56373),c=a(45808),u=a(85893),d=a(1922),p=a(88911),w=a(46072),f=a(84196);let m={swap:{title:"transaction_history.name_swap",desc:"transaction_history.desc_swap",txHistoryTitle:"transaction_history.name_swap",txHistoryDesc:"transaction_history.desc_swap",components:{sub:(0,u.jsx)(p.x,{as:"span",color:f.O9.textSecondary,fontWeight:"700"})}}},g=t=>{let{action:e,values:a={}}=t,n=m[e];return{title:w.ZP.t(n.title,a),description:(0,u.jsx)(d.cC,{i18nKey:n.desc,values:a,components:n.components}),txHistoryTitle:n.txHistoryTitle||n.title,txHistoryDesc:n.txHistoryDesc||n.desc,txValues:a}};var v=a(51758),_=a(90482),y=a(86221),S=a(39777),x=a(81319),h=a(85736),E=a(58467),A=a(48764).Buffer;let b=async()=>{let t=i.qr.getState().getPriorityFee();if(isNaN(parseFloat(String(t)||""))){var e;let t=await (0,y.b)(),{avg:a}=null!==(e=null==t?void 0:t[15])&&void 0!==e?e:{};if(!a)return;return{units:6e5,microLamports:a}}return{units:6e5,microLamports:new _.Z(t).mul(10**r._Fs.decimals).toDecimalPlaces(0).toNumber()}},T="_r_swap_slippage_",k={slippage:.005},C=(0,i.MT)(()=>({...k,swapTokenAct:async t=>{var e,a,u,d;let{swapResponse:p,wrapSol:f,unwrapSol:m=!1,onCloseToast:y,...T}=t,{publicKey:k,raydium:C,txVersion:V,connection:I,signAllTransactions:P,urlConfigs:Z}=i.qr.getState();if(!C||!I){console.error("no connection");return}if(!k||!P){console.error("no wallet");return}try{let t=i.uM.getState().tokenMap,[u,d]=[t.get(p.data.inputMint),t.get(p.data.outputMint)],[q,H]=[f&&(0,l.Th)(p.data.inputMint),(0,l.Th)(p.data.outputMint)],W=await C.account.getCreatedTokenAccount({programId:new n.nh(null!==(e=u.programId)&&void 0!==e?e:E.H_),mint:new n.nh(u.address),associatedOnly:!1});if(!W&&!q){console.error("no input token acc");return}let D=await C.account.getCreatedTokenAccount({programId:new n.nh(null!==(a=d.programId)&&void 0!==a?a:E.H_),mint:new n.nh(d.address)}),L=await b(),R=V===r.eVA.V0,{data:B,success:M}=await c.ZP.post("".concat(Z.SWAP_HOST).concat(Z.SWAP_TX).concat("BaseIn"===p.data.swapType?"swap-base-in":"swap-base-out"),{wallet:k.toBase58(),computeUnitPriceMicroLamports:new _.Z((null==L?void 0:L.microLamports)||0).toFixed(0),swapResponse:p,txVersion:R?"V0":"LEGACY",wrapSol:q,unwrapSol:m,inputAccount:q?void 0:null==W?void 0:W.toBase58(),outputAccount:H?void 0:null==D?void 0:D.toBase58()});if(!M){o.w.next({title:"Make Transaction Error",description:"Please try again, or contact us on discord",status:"error"}),y&&y();return}let F=(B||[]).map(t=>A.from(t.transaction,"base64")),N=F.map(t=>R?n.GS.deserialize(t):n.YW.from(t)),O=await P(N);console.log("simulate tx string:",O.map(r.Lj));let K=O.length,{toastId:j,handler:G}=(0,S.xl)({txLength:K,...T}),Y=g({action:"swap",values:{amountA:(0,v.Hk)(new _.Z(p.data.inputAmount).div(10**(u.decimals||0)).toString(),u.decimals),symbolA:(0,l.h3)({mint:u,transformSol:f}),amountB:(0,v.Hk)(new _.Z(p.data.outputAmount).div(10**(d.decimals||0)).toString(),d.decimals),symbolB:(0,l.h3)({mint:d,transformSol:m})}}),z=[],Q=t=>0===t?"transaction_history.set_up":t===z.length-1&&z.length>2?"transaction_history.clean_up":"transaction_history.name_swap",U=0,X=async()=>{if(!O[U])return;let t=O[U],e=R?await I.sendTransaction(t,{skipPreflight:!0,maxRetries:0}):await I.sendRawTransaction(t.serialize(),{skipPreflight:!0,maxRetries:0});if(z.push({txId:e,signedTx:t,status:"sent"}),1===O.length){s.aV.next({txId:e,...Y,signedTx:t,onClose:y,isSwap:!0,mintInfo:[u,d],...T});return}let a=0,n=I.onSignature(e,t=>{a&&window.clearTimeout(a);let n=z.findIndex(t=>t.txId===e);n>-1&&(z[n].status=t.err?"error":"success"),(0,x.WH)(z);let r=(0,h.a)(t);(0,S.r4)({toastId:j,processedId:z.map(t=>({...t,status:"sent"===t.status?"info":t.status})),txLength:K,meta:{...Y,title:r?w.ZP.t("error.error.swap_slippage_error_title"):Y.title,description:r?w.ZP.t("error.error.swap_slippage_error_desc"):Y.description},isSwap:!0,handler:G,getSubTxTitle:Q,onCloseToast:y}),t.err||X()},"processed");I.getSignatureStatuses([e]),(0,x.WH)(z),(0,S.r4)({toastId:j,processedId:z.map(t=>({...t,status:"sent"===t.status?"info":t.status})),txLength:K,meta:Y,isSwap:!0,handler:G,getSubTxTitle:Q,onCloseToast:y}),a=window.setTimeout(()=>{I.removeSignatureListener(n)},s.QE),U++};X()}catch(t){null===(u=T.onError)||void 0===u||u.call(T),"tx failed"!==t.message&&o.w.next({txError:"string"==typeof t?Error(t):t,title:"Swap",description:"Send transaction failed"})}finally{null===(d=T.onFinally)||void 0===d||d.call(T)}return""},unWrapSolAct:async t=>{let{amount:e,onSent:a,onError:n,...l}=t,c=i.qr.getState().raydium;if(!c)return;let{execute:u}=await c.tradeV2.unWrapWSol({amount:e}),d={amount:(0,v.Lu)(new _.Z(e).div(10**r._Fs.decimals).toFixed(r._Fs.decimals))},p={title:w.ZP.t("swap.unwrap_all_wsol",d),description:w.ZP.t("swap.unwrap_all_wsol_desc",d),txHistoryTitle:"swap.unwrap_all_wsol",txHistoryDesc:"swap.unwrap_all_wsol_desc",txValues:d};return u().then(t=>{let{txId:e,signedTx:n}=t;return null==a||a(),s.aV.next({txId:e,signedTx:n,...p,...l}),e}).catch(t=>(null==n||n(),o.w.next({txError:t,...p}),""))},wrapSolAct:async t=>{let e=i.qr.getState().raydium;if(!e)return;let{execute:a}=await e.tradeV2.wrapWSol(new _.Z(t).mul(10**r._Fs.decimals).toFixed(0));return a().then(t=>{let{txId:e,signedTx:a}=t;return s.aV.next({txId:e,signedTx:a}),e}).catch(t=>(o.w.next({txError:t,title:"Wrap Sol"}),""))}}),"useSwapStore")},73071:function(t,e,a){a.d(e,{P:function(){return S},Z:function(){return x}});var n=a(67294),r=a(59917),i=a(44718),o=a(54306),s=a(17638),l=a(10234),c=a(60050),u=a(60374),d=a(20474),p=a(84617),w=a(13717),f=a(8591),m=a(45808),g=a(85518);let v=async t=>{try{var e,a,n,r,i;let{rpcs:o,rpcNodeUrl:s}=l.qr.getState(),c=(0,g.rQ)(window.navigator.userAgent),u=c.device.type||"pc",d=null===(e=l.qr.getState().wallet)||void 0===e?void 0:e.adapter,p=await m.ZP.post("".concat(l.qr.getState().urlConfigs.SERVICE_1_BASE_HOST,"/check-tx"),{walletName:(null==d?void 0:d.name)||"unknown",metaData:(null==d?void 0:d.name)==="WalletConnect"?null===(a=null==d?void 0:d._wallet._session)||void 0===a?void 0:null===(n=a.peer)||void 0===n?void 0:null===(r=n.metadata)||void 0===r?void 0:r.name:void 0,deviceType:u,rpc:(null===(i=o.find(t=>t.url===s))||void 0===i?void 0:i.name)||"userChange",...t},{skipError:!0});return p}catch(t){return{id:"",success:!1,msg:t.message||"validate tx failed"}}},_=async t=>{try{var e;let a=await m.ZP.post("".concat(l.qr.getState().urlConfigs.SERVICE_1_BASE_HOST,"/ins-extend"),{walletName:(null===(e=l.qr.getState().wallet)||void 0===e?void 0:e.adapter.name)||"unknown",data:t},{skipError:!0});return a}catch(t){return{id:"",data:[],success:!1,msg:t.message||"extend tx failed"}}};var y=a(48764).Buffer;let S="walletName";var x=function(t){let{connection:e}=(0,i.R)(),{publicKey:a,signAllTransactions:m,signTransaction:x,wallet:h,connected:E}=(0,o.O)(),A=(0,n.useMemo)(()=>{let t=(0,p.P9)("_r_f_wallet_");if((0,d.D0)()&&t)try{return(0,s.Uk0)({publicKey:t})}catch(t){}return a},[a]),b=(0,n.useMemo)(()=>m?async t=>{var e,a,n;let i=l.qr.getState().txVersion===s.eVA.V0,o=[...t],c=o.map(s.Lj);if((null===(e=null===(a=l.qr.getState().wallet)||void 0===a?void 0:a.adapter.name)||void 0===e?void 0:e.toLowerCase())==="walletconnect"){let{success:t,data:e}=await _(c);if(t){let t=e.map(t=>y.from(t,"base64"));c=(o=t.map(t=>i?r.GS.deserialize(t):r.YW.from(t))).map(s.Lj)}}let u=(0,g.rQ)(window.navigator.userAgent),d=null===(n=l.qr.getState().wallet)||void 0===n?void 0:n.adapter,p="Android"===u.os.name&&(null==d?void 0:d.name)==="Coinbase Wallet",w=Date.now(),f=[];if(p)for(let t of o){let e=await x(t);f.push(e)}else f=await m(o);let S=f.map(s.Lj),h=await v({preData:c,data:S,userSignTime:Date.now()-w});if(!h.success)throw Error(h.msg);return f}:void 0,[m]),{urlConfigs:T,fetchRpcsAct:k,initRaydiumAct:C,raydium:V}=(0,l.qr)(t=>({urlConfigs:t.urlConfigs,fetchRpcsAct:t.fetchRpcsAct,initRaydiumAct:t.initRaydiumAct,raydium:t.raydium}),u.Z),I=(0,n.useRef)(h),P=(0,n.useRef)({}),Z=(0,c.Z)(e.rpcEndpoint),q=(0,c.Z)(T),H=!!Z&&Z!==e.rpcEndpoint,W=H||T!==q;P.current={publicKey:A};let D=(0,n.useCallback)(t=>{w.w.next({title:"".concat(null==h?void 0:h.adapter.name," wallet connected"),description:"Wallet ".concat(t),status:"success"})},[h]),L=(0,n.useCallback)(()=>{w.w.next({title:"".concat(null==h?void 0:h.adapter.name," wallet disconnected"),status:"warning"})},[h]);(0,n.useEffect)(()=>{var t;(null===(t=l.qr.getState().rpcs)||void 0===t?void 0:t.length)||k()},[k,T.BASE_HOST]),(0,n.useEffect)(()=>(null==h||h.adapter.once("connect",D),null==h||h.adapter.once("disconnect",L),I.current=h||I.current,()=>{null==h||h.adapter.off("connect",D),null==h||h.adapter.off("disconnect",L)}),[h,D,L]),(0,n.useEffect)(()=>{if(e&&e.rpcEndpoint!==l.wd){if(l.qr.setState({connection:e,signAllTransactions:b},!1,{type:"useInitConnection"}),V&&!W){V.setConnection(e);return}C({connection:e,...W?{}:t})}},[C,null==e?void 0:e.rpcEndpoint,V,b,W]),(0,n.useEffect)(()=>{V&&(V.setOwner(A||void 0),V.setSignAllTransactions(b))},[V,A,b]),(0,n.useEffect)(()=>{let t={connected:!!P.current.publicKey,publicKey:P.current.publicKey||void 0,wallet:I.current||void 0};l.qr.setState(t,!1,{type:"useInitConnection",payload:t})},[null==A?void 0:A.toBase58(),null==h?void 0:h.adapter.name]),(0,n.useEffect)(()=>d.MK,[e.rpcEndpoint]),(0,n.useEffect)(()=>{if(h)return"SafePal"===h.adapter.name&&l.qr.setState({txVersion:s.eVA.LEGACY}),()=>l.qr.setState({txVersion:s.eVA.V0})},[null==h?void 0:h.adapter.name]),(0,n.useEffect)(()=>{E&&A&&((0,f.e)({type:"connectWallet",connectStatus:"success",walletName:(null==h?void 0:h.adapter.name)||"unknown"}),h&&localStorage.setItem(S,'"'.concat(null==h?void 0:h.adapter.name,'"')))},[A,E,null==h?void 0:h.adapter.name])}},60050:function(t,e,a){a.d(e,{Z:function(){return r}});var n=a(67294);function r(t){let e=(0,n.useRef)();return(0,n.useEffect)(()=>{e.current=t},[t]),e.current}}}]);