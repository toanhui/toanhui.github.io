"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7763],{7763:function(e,t,r){r.r(t),r.d(t,{ACTION_COLOR_MAP:function(){return Z},AdvancedTradingView:function(){return K},CHAOS_ENDPOINT_BASE_URL:function(){return k},CHAOS_IDS:function(){return N},CHAOS_SUBSCRIPTION_MESSAGE:function(){return A},CHAOS_WEBSOCKET_URL:function(){return S},chaosWebsocket:function(){return V},dissectFromToAddress:function(){return T},getChannelString:function(){return B},getFromToAddress:function(){return D},getNextBarTime:function(){return p},getResolutionTime:function(){return g},makeApiRequest:function(){return m},parseResolution:function(){return b},subscribeOnStream:function(){return j},unsubscribeFromStream:function(){return R}});var o=r(20892),n=r(19704),s=(r(14914),r(24086)),i=(r(88442),r(97522)),a=r(56155),l=r(93981),c=r(13838),u=r(29541),d=r(3872),h=r(11805);function m(e,t){return(0,a.Cr)(this,null,(function*(){try{return(yield fetch(`https://fe-api.jup.ag/api/v1/charts/${e}?${t}`)).json()}catch(r){throw new Error(`Birdeye request error: ${r.status}`)}}))}var f={1:"1m",3:"3m",5:"5m",15:"15m",30:"30m",60:"1H",120:"2H",240:"4H","1D":"1D","1W":"1W"};function b(e){return e&&f[e]?f[e]:f[1]}var _={1:60,3:180,5:300,15:900,30:1800,60:3600,120:7200,240:14400,"1D":86400,"1W":604800};function g(e){const t=Math.floor(Date.now()/1e3);if(!e||!_[e])return{timeFrom:t-_[1],timeTo:t};return{timeFrom:t-_[e],timeTo:t}}function p(e,t="1D"){if(!e)return;const r=parseInt(t.slice(0,-1),10);let o;switch(t.slice(-1)){case"W":o=6048e5*r+e.time;break;case"D":o=864e5*r+e.time;break;case"H":o=36e5*r+e.time;break;case"m":o=6e4*r+e.time;break;default:throw new Error("Unhandle resolution in getNextBarTime")}return o}var v=new Map,y=new Map,C={supported_resolutions:["1","3","5","15","30","60","120","240","1D","1W"],exchanges:[]};function D(e,t){return`address:${e}/${t}`}function T(e){return e.replace("address:","").split("/")}function B(e,t,r){return`0~${e}~${t}~${r}`}var w=function(e,t){return{onReady:e=>{t&&console.log("[onReady]: Method call"),setTimeout((()=>e(C)))},searchSymbols:(e,t,r,o)=>(0,a.Cr)(this,null,(function*(){})),resolveSymbol:(t,r,o,n)=>(0,a.Cr)(this,null,(function*(){const[o,n]=T(t),[s,i]=[e(o),e(n)],l=`${null==s?void 0:s.address}/${null==i?void 0:i.address}`,c={address:t,ticker:l,name:l,description:l,type:"",session:"24x7",timezone:"Etc/UTC",minmov:1,pricescale:(0,a.f3)(10,16),has_intraday:!0,has_no_volume:!0,visible_plots_set:"ohlc",has_weekly_and_monthly:!1,supported_resolutions:C.supported_resolutions,volume_precision:2,data_status:"streaming",full_name:l,exchange:"",listed_exchange:"",format:"price"};r(c)})),getBars:(r,o,s,i,l)=>(0,a.Cr)(this,null,(function*(){var c;const{from:u,to:d,firstDataRequest:h}=s;t&&console.log("[getBars]: Method call",{symbolInfo:r,resolution:o,time_from:u,time_to:d});const[f,_]=T(r.address),[g,p]=[e(f),e(_)];if(!g||!p)throw new Error("Token info not found");const y=new URLSearchParams({quote_address:p.address,type:b(o),time_from:String(u),time_to:String(d)});try{const e=yield m(g.address,y.toString());if(0===e.bars.length)return void i([],{noData:!0});let r=[];const s=B(g.address,p.address,o),l=(null==(c=v.get(s))?void 0:c.time)||0;e.bars.forEach((e=>{if(e.t>=u&&e.t<d){1e3*e.t>l&&n.e_.set(n.hp,{symbol:`${g.address}/${p.address}`,price:e.c}),r.push({time:1e3*e.t,low:e.l,high:e.h,open:e.o,close:e.c,volume:e.v})}})),h&&v.set(s,(0,a.ih)({},r[r.length-1])),t&&console.log(`[getBars]: returned ${r.length} bar(s)`),i(r,{noData:!1})}catch(C){t&&console.log("[getBars]: Get error",C),l(String(C))}})),subscribeBars:(r,o,s,i,l)=>{t&&console.log("[subscribeBars]: Method call with subscriberUID:",i);const[c,u]=T(r.address),[d,h]=[e(c),e(u)];if(!d||!h)throw new Error("Token info not found");const f=setInterval((()=>(0,a.Cr)(this,null,(function*(){try{const{timeFrom:e,timeTo:t}=g(o),r=new URLSearchParams({quote_address:h.address,type:b(o),time_from:e.toString(),time_to:t.toString()}),i=yield m(d.address,r.toString());if(i.bars.length>0){const e=i.bars[i.bars.length-1];n.e_.set(n.hp,{symbol:`${d.address}/${h.address}`,price:e.c}),s({time:1e3*e.t,low:e.l,high:e.h,open:e.o,close:e.c,volume:e.v})}}catch(e){t&&console.log("[subscribeBars]: Polling error",e),clearInterval(f),y.delete(i)}}))),6e4);y.set(i,f)},unsubscribeBars:e=>{t&&console.log("[unsubscribeBars]",e);const r=y.get(e);r&&(clearInterval(r),y.delete(e))}}};var E=({value:e,maxSuffix:t})=>{const[r,o,n]=((e,t=6)=>{if(0===e)return[0,"0","0"];const r=c.Z.ceil(new c.Z(-1).mul(c.Z.log10(c.Z.abs(e)))).toNumber();if(new c.Z(e).gte(1e-4)){const[t,r]=new c.Z(e).toSignificantDigits(4).toFixed().split(".");return[0,t||"",r||""]}const o=new c.Z(e).toFixed().slice(0,r+2),n=new c.Z(e).toFixed().slice(1+r).slice(0,t);return[r,o,n]})(e);return new c.Z(e).gte(1e-4)?e.toFixed(n.length):"0.0"+function(e){const t=["\u2080","\u2081","\u2082","\u2083","\u2084","\u2085","\u2086","\u2087","\u2088","\u2089"],r=e.toString();let o="";for(let n=0;n<r.length;n++){const e=t[parseInt(r.charAt(n),10)];e&&(o+=e)}return o}(r-1)+n.slice(0,t)},S="wss://history.oraclesecurity.org/trading-view/stream",k="https://history.oraclesecurity.org",A={a:"subscribe",ch:["btcusd","ethusd","solusd"]},N={So11111111111111111111111111111111111111112:"SOLUSD","7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs":"ETHUSD","3NZ9JMVBmGAqocybic2c7LQCJScmgsAZ6vQqTDzcqmJh":"BTCUSD"},I={1:"1",2:"2",5:"5",15:"15",30:"30",60:"1H",120:"2H",240:"4H",360:"6H",720:"12H","1D":"1D","1M":"1M"},P=e=>e&&I[e]?I[e]:I[1];function U(e){return new Promise((t=>setTimeout(t,e)))}var V=new class{constructor(){this.channelToSubscription=new Map}createSocket(e=2){return(0,a.Cr)(this,null,(function*(){return this.socket=this.socket?this.socket:new WebSocket(S),new Promise(((t,r)=>(0,a.Cr)(this,null,(function*(){let o=5;for(;o>0;){if(yield U(500),this.socket&&this.socket.readyState===this.socket.OPEN)return t(this.socket);o--}if(e>0){const r=yield this.createSocket(e-1);if(r instanceof WebSocket)return t(r)}r({status:"error"})}))))}))}closeSocket(){return(0,a.Cr)(this,null,(function*(){this.socket&&(this.socket.close(),this.socket=void 0)}))}subscribeOnStream(e,t,r,o,s,i){return(0,a.Cr)(this,null,(function*(){const s=`0~${e.name}~${t}`,l={id:o,callback:r};let c=this.channelToSubscription.get(s);c={subscriberUID:o,resolution:t,lastBar:i,handlers:[l],unsubscribePrice:()=>{}},this.channelToSubscription.set(s,c);const u=(0,n.o_)(e.name),d=n.e_.sub(u,(()=>{const r=n.e_.get(u);if(r){const{price:o,time:n}=r,s=`0~${e.name}~${t}`,i=this.channelToSubscription.get(s);if(void 0===i)return;const l=i.lastBar,c=function(e,t){let r;r="D"===t.slice(-1)?864e5+e.time:60*Number(t)*1e3+e.time;return r}(l,t);let u;n>=c?(u={time:c,open:l.close,high:o,low:o,close:o},"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.log("[socket] Generate new bar",u)):(u=(0,a.EZ)((0,a.ih)({},l),{high:Math.max(l.high,o),low:Math.min(l.low,o),close:o}),"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.log("[socket] Update the latest bar by price",o)),i.lastBar=u,i.handlers.forEach((e=>e.callback(u)))}}));c.unsubscribePrice=d}))}unsubscribeFromStream(e){return(0,a.Cr)(this,null,(function*(){for(const t of this.channelToSubscription.keys()){const r=this.channelToSubscription.get(t);null==r||r.unsubscribePrice();if(-1!==(null==r?void 0:r.handlers.findIndex((t=>t.id===e)))){"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.log("[unsubscribeBars]: Unsubscribe from streaming. Channel:",t),this.channelToSubscription.delete(t);break}}}))}},x={supported_resolutions:["1","5","15","30","60","120","240","360","720","1D","1M"]},L=new Map,$=()=>({onReady:e=>{"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.error("[onReady]: Method call"),setTimeout((()=>e(x)))},searchSymbols:()=>(0,a.Cr)(void 0,null,(function*(){"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.error("[searchSymbols]: Method call")})),resolveSymbol:(e,t)=>(0,a.Cr)(void 0,null,(function*(){"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.error("[resolveSymbol]: Method call",e),t({name:e,ticker:e,description:e,type:"",session:"24x7",timezone:"Etc/UTC",minmov:1,pricescale:(0,a.f3)(10,2),has_intraday:!0,has_no_volume:!0,visible_plots_set:"ohlc",has_weekly_and_monthly:!0,supported_resolutions:x.supported_resolutions,volume_precision:2,data_status:"streaming",full_name:e,exchange:"Chaos",listed_exchange:"",format:"price"})})),getBars:(e,t,r,o,n)=>(0,a.Cr)(void 0,null,(function*(){const{from:s,to:i,firstDataRequest:l}=r;"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.log("[getBars]: Method call",e,t,r);const c=new URLSearchParams({feed:e.name,type:P(t),from:(1e3*s).toString(),till:(1e3*i).toString()});try{const r=yield fetch(`${k}/trading-view/data?${c.toString()}`);if("1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.log("[getBars]: Get Chaos Historical Data",r.json()),!r.ok)return void o([],{noData:!0});const n=yield r.json();if(!n.result||!n.result.length)return void o([],{noData:!0});let u=[];n.result.forEach((e=>{e.time>=1e3*s&&e.time<1e3*i&&(u=[...u,{time:e.time,low:e.low,high:e.high,open:e.open,close:e.close}])})),l&&L.set(e.ticker+t,(0,a.ih)({},u[u.length-1])),o(u,{noData:!1})}catch(u){"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.log("[getBars]: Get Chaos Historical Data Error",u),n(String(u))}})),subscribeBars:(e,t,r,o,n)=>(0,a.Cr)(void 0,null,(function*(){"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.error("[subscribeBars]: Method call with listenerGuid:",o);const s=L.get(e.ticker+t);if(!s)throw new Error("ChaosTVDataFeed: lastBar is not found");yield V.subscribeOnStream(e,t,r,o,n,s)})),unsubscribeBars:e=>(0,a.Cr)(void 0,null,(function*(){"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.error("[unsubscribeBars]: Method call with listenerGuid:",e),yield V.unsubscribeFromStream(e)}))}),M=new Map;function G(e,t){const{price:r,time:o}=t,n=r,s=1e3*o,i=e,l=M.get(i);if(!l)return;const c=l.lastDailyBar,u=function(e){const t=new Date(1e3*e);return t.setDate(t.getDate()+1),t.getTime()/1e3}(c.time);let d;s>=u?(d={time:u,open:n,high:n,low:n,close:n},"1"===h.env.DEBUG_ADVANCED_TV&&console.log("[stream] Generate new bar",d)):(d=(0,a.EZ)((0,a.ih)({},c),{high:Math.max(c.high,n),low:Math.min(c.low,n),close:n}),"1"===h.env.DEBUG_ADVANCED_TV&&console.log("[stream] Update the latest bar by price",n)),l.lastDailyBar=d,l.handlers.forEach((e=>e.callback(d))),M.set(i,l)}function j(e,t,r,o,s,i){const a=e.ticker+t||"",l={id:o,callback:r};let c=M.get(a);c={subscriberUID:o,resolution:t,lastDailyBar:i,handlers:[l],unsub:()=>{}},M.set(a,c),"1"===h.env.DEBUG_ADVANCED_TV&&console.log("[subscribeBars]: Subscribe to streaming. Channel:",a);const u=(0,n.EA)(e.ticker),d=n.e_.sub(u,(()=>{const e=n.e_.get(u);e&&G(a,e)}));c.unsub=d}function R(e){for(const t of M.keys()){const r=M.get(t);null==r||r.unsub();if(-1!==r.handlers.findIndex((t=>t.id===e))){"1"===h.env.DEBUG_ADVANCED_TV&&console.log("[unsubscribeBars]: Unsubscribe from streaming. Channel:",t),M.delete(t);break}}}var O="https://benchmarks.pyth.network/v1/shims/tradingview",F=["1","2","5","15","30","60","120","240","360","720","1D"],X=new Map;var H,q=()=>({onReady:e=>{"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.error("[onReady]: Method call"),d((e=>(0,a.Cr)(void 0,null,(function*(){try{const e=yield fetch(`${O}/config`);return yield e.json()}catch(t){e(t)}}))),{retries:5,minTimeout:1e3}).then((t=>{e((0,a.EZ)((0,a.ih)({},t),{supported_resolutions:F}))})).catch((e=>{"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.error(e)}))},searchSymbols:(e,t,r,o)=>{"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.error("[searchSymbols]: Method call"),d((t=>(0,a.Cr)(void 0,null,(function*(){try{const t=yield fetch(`${O}/search?query=${e}`);return yield t.json()}catch(r){return t(r)}}))),{retries:5,minTimeout:1e3}).then((e=>{o(e)})).catch((e=>{"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.error(e)}))},resolveSymbol:(e,t,r)=>{"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.error("[resolveSymbol]: Method call",e),d((t=>(0,a.Cr)(void 0,null,(function*(){try{const t=yield fetch(`${O}/symbols?symbol=${e}`),r=yield t.json(),{precisionToDisplay:o}=yield function(e){return(0,a.Cr)(this,null,(function*(){const t=((new Date).getTime()/1e3).toFixed(0),r=yield fetch(`${O}/history?symbol=${e.ticker}&from=${Number(t)-1e3}&to=${t}&resolution=15`),o=(yield r.json()).c[0];return{closePrice:o,precisionToDisplay:(0,i.y_)(o)}}))}(r);return{symbolInfo:(0,a.EZ)((0,a.ih)({},r),{supported_resolutions:F}),precisionToDisplay:o}}catch(r){return t(r)}}))),{retries:5,minTimeout:1e3}).then((({symbolInfo:e,precisionToDisplay:r})=>{t((0,a.EZ)((0,a.ih)({},e),{pricescale:(0,a.f3)(10,r)}))})).catch((t=>{"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.error("[resolveSymbol]: Cannot resolve symbol",e,t),r("Cannot resolve symbol")}))},getBars:(e,t,r,o,n)=>{const{from:s,to:i,firstDataRequest:l}=r;d((o=>(0,a.Cr)(void 0,null,(function*(){try{const o=yield fetch(`${O}/history?symbol=${e.ticker}&from=${r.from}&to=${r.to}&resolution=${t}`);return yield o.json()}catch(n){return o(n)}}))),{retries:5,minTimeout:1e3}).then((r=>{if("1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.log("[getBars]: Method call",e,t,s,i),0===r.t.length)return void o([],{noData:!0});const n=[];for(let e=0;e<r.t.length;++e)n.push({time:1e3*r.t[e],low:r.l[e],high:r.h[e],open:r.o[e],close:r.c[e]});l&&X.set(e.ticker+t,(0,a.ih)({},n[n.length-1])),o(n,{noData:!1})})).catch((e=>{"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.error("[getBars]: Get error",e),n(e)}))},subscribeBars:(e,t,r,o,n)=>{"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.error("[subscribeBars]: Method call with subscriberUID:",o),j(e,t,r,o,0,X.get(e.ticker+t))},unsubscribeBars:e=>{"1"===h.env.NEXT_PUBLIC_DEBUG_ADVANCED_TV&&console.error("[unsubscribeBars]: Method call with subscriberUID:",e),R(e)}}),Z={long:{main:"#32DF7B",shade:"#32DF7BB3"},short:{main:"#EB5757",shade:"#EB5757B3"},tp:{main:"#00BCF0",shade:"#00BCF0B3"},sl:{main:"#00BCF0",shade:"#00BCF0B3"},lq:{main:"rgb(100,116,139)",shade:"rgb(100,116,139)"}},W={enableVolumeStudy:!0,useUserBrowserTime:!0,showSeriesOHLC:!0,showVolume:!0,showPriceSource:!0,showBarChange:!0,isMobile:!1},z="TRADING_VIEW_STATE",J=e=>{window.localStorage.setItem(z,JSON.stringify(e))},Q={current:null};function K({renderingId:e,datafeedObject:t,style:r,tvClassName:n,shadesClassName:d,desktopOverlayExplanation:h,positions:m,opt:f,hasFocus:b,favoriteIntervals:_,restartCount:g}){const p=(0,s.XA)(),[v,y]=(0,s._)("lastInterval","15"),C=(0,l.useMemo)((()=>(0,a.EZ)((0,a.ih)((0,a.ih)({},W),f),{isMobile:p})),[f,p]),T=(0,l.useMemo)((()=>`${e}-tradingview-chart`),[e]),B=(0,l.useRef)(null),{getTokenInfo:S}=(0,o.Bn)(),k=(0,l.useRef)(null),A=(0,l.useRef)(),N=(0,l.useMemo)((()=>{var e,r;return A.current=t,[null==(e=null==t?void 0:t.baseTokenInfo)?void 0:e.address,null==(r=null==t?void 0:t.quoteTokenInfo)?void 0:r.address,null==t?void 0:t.pythId,null==t?void 0:t.subscriptionId,null==t?void 0:t.feedId,g].filter(Boolean).join("_")}),[t,g]);(0,l.useEffect)((()=>{Q.current&&g&&O()}),[g]);const{symbol:I,tickerName:P,datafeed:U}=(0,l.useMemo)((()=>{if("pythId"in t)return{symbol:t.symbol,tickerName:t.tickerName,datafeed:q()};if("feedId"in t)return{symbol:t.feedId,tickerName:t.feedId,datafeed:$()};const{baseTokenInfo:e,quoteTokenInfo:r}=t;return e&&r?(B.current||(B.current=w(S)),{symbol:D(e.address,r.address),tickerName:`${e.symbol}/${r.symbol}`,datafeed:B.current}):{symbol:null,tickerName:null,datafeed:null}}),[N,S]),[V,x]=(0,l.useState)(!1),[L,M]=(0,l.useState)(!1),[G,j]=(0,l.useState)(!1),R=(0,l.useCallback)((()=>(0,a.Cr)(this,null,(function*(){if(P&&!G&&I&&U&&(M(!1),document.getElementById(T)&&"TradingView"in window)){const e=["hide_left_toolbar_by_default","save_shortcut","create_volume_indicator_by_default"],t=["popup_hints","header_symbol_search","symbol_search_hot_key","header_compare","timeframes_toolbar","header_undo_redo","display_market_status"];p&&t&&(t.push("vert_touch_drag_scroll"),t.push("axis_pressed_mouse_move_scale"));const r=(()=>{const e=window.localStorage.getItem(z);return e?JSON.parse(e):void 0})();Q.current=new window.TradingView.widget({symbol:I,interval:v||"15",locale:"en",container:T,theme:"dark",autosize:!0,custom_css_url:"https://static.jup.ag/tv/css/tradingview.css",settings_overrides:{"chartEventsSourceProperties.breaks.visible":!1,"paneProperties.legendProperties.showSeriesTitle":!1,"paneProperties.background":"#131B24","paneProperties.backgroundType":"solid","paneProperties.legendProperties.backgroundTransparency":50,"paneProperties.legendProperties.showSeriesOHLC":C.showSeriesOHLC,"paneProperties.legendProperties.showBarChange":C.showBarChange,"paneProperties.legendProperties.showVolume":C.showVolume,"paneProperties.legendProperties.showPriceSource":C.showPriceSource,"scalesProperties.showSeriesPrevCloseValue":!1,"scalesProperties.showSymbolLabels":!1,"scalesProperties.showStudyPlotLabels":!1,"scalesProperties.showFundamentalNameLabel":!1,"scalesProperties.fontSize":C.isMobile?7:12},overrides:{"mainSeriesProperties.highLowAvgPrice.highLowPriceLabelsVisible":!0,"mainSeriesProperties.highLowAvgPrice.highLowPriceLinesVisible":!0},width:"100%",height:"100%",datafeed:U,library_path:"https://static.jup.ag/tv/charting_library/bundles",disabled_features:t,enabled_features:e,custom_formatters:{priceFormatterFactory:()=>({format:e=>{const t=E({value:e,maxSuffix:6}),r=(0,i.y_)(e);return new c.Z(e).gt(1e-4)?i.uf.format(e.toString(),r):t}})},favorites:{intervals:_&&_.length?_:["1","30","1h"],chartTypes:["Candles","Area","Columns"]},saved_data:r})}}))),[P,G,I,U,v,_,C,p]);(0,l.useEffect)((()=>{if(P)return H||(H=new Promise((e=>{const t=document.createElement("script");t.id="tradingview-widget-loading-script",t.src="https://static.jup.ag/tv/charting_library/charting_library.js",t.type="text/javascript",t.onload=e,document.head.appendChild(t)}))).then((()=>{R()})),"TradingView"in window&&R(),()=>{Q.current=null}}),[p]),(0,l.useEffect)((()=>{try{if(!Q.current||!Q.current.activeChart())return;if("pythId"in t)return void Q.current.activeChart().setSymbol(t.symbol);if("feedId"in t)return void Q.current.activeChart().setSymbol(t.feedId);t.baseTokenInfo&&t.quoteTokenInfo&&Q.current.activeChart().setSymbol(D(t.baseTokenInfo.address,t.quoteTokenInfo.address))}catch(e){console.log(e)}}),[N]);const O=()=>(0,a.Cr)(this,null,(function*(){var e;x(!1),null==(e=Q.current)||e.remove();try{yield R(),x(!0)}catch(t){console.log(t)}}));return(({isLoaded:e,widget:t,positions:r})=>{const{wallet:n}=(0,o.Os)(),{connection:s}=(0,o.Bn)(),i=(0,l.useRef)([]);(0,l.useEffect)((()=>{t&&e?r&&r.length>0&&r.forEach((e=>{if(t&&!i.current.find((t=>t.id===e.id)))try{t.onChartReady((()=>{let r;const o=Z[e.action].main,n=Z[e.action].shade;"lq"===e.action?r=t.activeChart().createPositionLine():(r=t.activeChart().createOrderLine(),r.setCancelTooltip("Market close").onCancel(r,(t=>{e.onCloseAction&&(t.setText(`Closing ${e.label}...`),e.onCloseAction(e).finally((()=>{t.setText(e.label)})))})).setCancelButtonBackgroundColor(n).setCancelButtonBorderColor(o).setCancelButtonIconColor("#fff")),r.setPrice(e.price).setText(e.label).setQuantity(`$${e.sizeUsd}`).setLineColor(o).setBodyBackgroundColor(n).setBodyBorderColor(o).setQuantityBorderColor(o).setQuantityBackgroundColor(n).setBodyTextColor("#fff").setQuantityTextColor("#fff"),i.current.push({id:e.id,adapter:r})}))}catch(r){console.error(r)}})):i.current=[]}),[r,i,t,e,n,s]),(0,l.useEffect)((()=>{Array.isArray(r)&&0===r.length?i.current.forEach(((e,t)=>{e.adapter.remove(),i.current=[]})):i.current.forEach(((e,t)=>{if(!(null==r?void 0:r.find((t=>t.id===e.id)))&&e.adapter&&e.adapter.remove)try{e.adapter.remove()}catch(G){}finally{i.current.splice(t,1)}}))}),[r])})({positions:m,isLoaded:V&&L,widget:Q.current}),(0,l.useEffect)((()=>{const e=setInterval((()=>{const e=Q.current,t=null==e?void 0:e.activeChart();!e||!t||V&&L||e.onChartReady((()=>{x(!0),A.current&&("pythId"in A.current?e.activeChart().setSymbol(A.current.symbol):"feedId"in A.current?e.activeChart().setSymbol(A.current.feedId):A.current.baseTokenInfo&&A.current.quoteTokenInfo&&e.activeChart().setSymbol(D(A.current.baseTokenInfo.address,A.current.quoteTokenInfo.address)));const t=e.activeChart().getAllStudies().find((e=>"Volume"===e.name));if(e.applyOverrides({"mainSeriesProperties.highLowAvgPrice.highLowPriceLabelsVisible":!0,"mainSeriesProperties.highLowAvgPrice.highLowPriceLinesVisible":!0,"paneProperties.legendProperties.showSeriesTitle":!1}),(null==f?void 0:f.enableVolumeStudy)&&!p?t||e.activeChart().createStudy("Volume"):t&&e.activeChart().removeEntity(t.id),e.subscribe("onAutoSaveNeeded",(()=>{e.save(J)})),e.activeChart().dataReady((()=>{setTimeout((()=>{M(!0)}),250)})),e.activeChart().onIntervalChanged().subscribe(null,(e=>{y(e)})),C.useUserBrowserTime&&Q.current){const t=e.activeChart().getTimezoneApi(),r=60*(new Date).getTimezoneOffset()*1e3*-1,o=t.availableTimezones().find((e=>e.offset===r));t.setTimezone((null==o?void 0:o.id)||"Etc/UTC")}}))}),1e3);return()=>{Q.current=null,clearInterval(e)}}),[]),(0,u.jsxs)("div",{ref:k,className:(0,i.cn)("relative flex-1 overflow-hidden transition-all"),style:G?{height:0}:(0,a.ih)({minHeight:200,height:"100%",width:"100%"},r),children:[(0,u.jsx)("div",{className:(0,i.cn)("pointer-events-none absolute left-0 top-0 h-full w-full transition-all",V&&L?"bg-transparent":`bg-v2-background ${d}`,"flex items-center justify-center"),children:V&&L?null:(0,u.jsx)(o.$j,{})}),(0,u.jsx)("div",{id:T,className:(0,i.cn)("h-full w-full",n,L?"opacity-100":"opacity-0"),style:(0,a.ih)({minHeight:200},r)}),h?(0,u.jsx)("div",{className:"absolute bottom-10 hidden w-full justify-center lg:bottom-20 lg:flex",children:(0,u.jsx)("div",{className:"text-v2-lily/60 w-[75%] text-xs font-semibold",children:(0,u.jsx)("div",{className:"flex items-center justify-center text-center",children:(0,u.jsx)("span",{children:h})})})}):null,h?(0,u.jsx)("div",{className:"text-v2-lily/60 mt-4 hidden h-[120px] lg:flex",children:h}):null]})}}}]);
//# sourceMappingURL=7763-efd8995f895873fa.js.map